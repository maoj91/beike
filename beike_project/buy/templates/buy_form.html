<html>

<head>
    <meta name="viewport" content="width=device-width ,  user-scalable=no">
    <meta charset="UTF-8">

    <!-- jquery library -->
    <link rel="stylesheet" type="text/css" href="/static/jquery/jquery.mobile-1.4.2.css">
    <script src="/static/jquery/jquery-1.8.3.js "></script>
    <script src="/static/jquery/jquery.mobile-1.4.2.js"></script>

    <!--js library for s3 upload-->
    <script src="/static/lodash.js"></script>
    <script type="text/javascript" src="/static/s3upload.js"></script>
    <script src="/static/exif.js"></script>
    <script src="/static/binaryajax.js"></script>

    <!-- beike customized css and js -->
    <link rel="stylesheet" type="text/css" href="/static/mystyle.css">
    <link rel="stylesheet" type="text/css" href="/static/me.css">
    <link rel="stylesheet" type="text/css" href="/static/buy.css">
    <link rel="stylesheet" type="text/css" href="/static/sell.css">
    <script src="/static/buy.js"></script>
    <script src="/static/sell.js"></script>
</head>

<body>
    <div data-role="page" id="main-page" data-theme="a">
        <div data-role="header" data-position="fixed">
            <img id='header' src='https://s3-us-west-2.amazonaws.com/beike-s3/static/img/04/header.png'>
        </div>

        <div data-role="content">
            <form action="/buy/form_submit/" method="post" enctype="multipart/form-data" onsubmit="return validateBuyForm()">
                {% csrf_token %}
                <div id="category_div">
                    <label for="category">类 别</label>
                    <select name='category'>
                        {% for category in categories %}
                        <option value={{ category.id }}>{{category.name}}</option>
                        {% endfor %}
                    </select>
                </div>
                <div id="title_div">
                    <label for='title'>标 题</label>
                    <input type="text" name="title" placeholder="请输入标题">
                    <p id="title_required" style="color: red;"></p>
                </div>
                <div id="price_div">
                    <label>价 格</label>
                    <input type="text" name="min_price" class="input_box" placeholder="最低价">
                    <input type="text" name="max_price" class="input_box" placeholder="最高价">$
                    <p id="price_required" style="color: red;"></p>
                </div>
                <div id="content_div">
                    <label for="content">详细描述</label>
                    <input type="text" name="content" class="input_box" placeholder="描述颜色、大小、形状、新旧等需求">
                </div>
                <div>
                    <input type="hidden" name="latitude" id="latitude"></input>
                    <input type="hidden" name="longitude" id="longitude"></input>
                </div>
                <div>
                    <input type="image" value="Submit" id="submit_btn" src="https://s3-us-west-2.amazonaws.com/beike-s3/static/img/04/submit.png">
                </div>
            </form>
        </div>
        <script type="text/javascript">
            function getLatitudeLongtitude(position) {
                var latitude = position.coords.latitude;
                var longitude = position.coords.longitude;
                $("#latitude").val(latitude);
                $("#longitude").val(longitude);
                $.ajax({
                    type: "get",
                    url: "/me/get_info/get_zipcode_by_latlong",
                    dataType: "json",
                    data: {
                        latitude: latitude,
                        longitude: longitude
                    }
                }).then(function(data) {
                    console.log(data);
                });
            }

            $(document).ready(function() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(getLatitudeLongtitude);
                }
            });
        </script>
    </div>
</body>

</html>

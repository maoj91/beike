<html>

<head>
    <meta name="viewport" content="width=device-width ,  user-scalable=no">
    <meta charset="UTF-8">

    <!-- jquery library -->
    <link rel="stylesheet" type="text/css" href="/static/jquery/jquery.mobile-1.4.2.css">
    <script src="/static/jquery/jquery-1.8.3.js "></script>
    <script src="/static/jquery/jquery.mobile-1.4.2.js"></script>

    <!--js library for s3 upload-->
    <script src="/static/lodash.js"></script>
    <script type="text/javascript" src="/static/s3upload.js"></script>
    <script src="/static/exif.js"></script>
    <script src="/static/binaryajax.js"></script>

    <!-- beike customized css and js -->
    <link rel="stylesheet" type="text/css" href="/static/common.css">
    <script src="/static/buy.js"></script>
    <script src="/static/sell.js"></script>
</head>

<body onload="initiatePage()">
    <div data-role="page" id="main-page" data-theme="a">
        <div data-role="header" data-position="fixed">
            <div style="background-color: rgb(35,192,148);">
                <div class="ui-grid-b">
                    <div class="ui-block-a">
                    </div>
                    <div class="ui-block-b">
                        <p style = "text-align:center; color:white">我要买</p>
                    </div>
                    <div class="ui-block-a">
                    </div>
                </div>
            </div>
        </div>

        <div data-role="content">
            <form action="/buy/form_submit/" method="post" enctype="multipart/form-data" onsubmit="return validateBuyForm()">
                {% csrf_token %}
                <div class="ui-grid-a">
                    <div class="ui-block-a" style="width:20%;">
                        <label for="category" class="form-label">类别</label>
                    </div>
                    <div class="ui-block-b" style="width:80%;">
                        <select name='category' id="category">
                            {% for category in categories %}
                            <option value={{ category.id }}>{{category.name}}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="ui-grid-a">
                    <div class="ui-block-a" style="width:20%;">
                        <label for="title" class="form-label">标题</label>
                    </div>
                    <div class="ui-block-b" style="width:80%">
                        <input type="text" name="title" id="title" placeholder="请输入标题" />
                    </div>
                </div>

                <div class="ui-grid-c">
                    <div class="ui-block-a" style="width:20%;">
                        <label class="form-label">价格</label>
                    </div>
                    <div class="ui-block-b" style="width:35%;">
                        <input type="number" name="min_price" placeholder="最低">
                    </div>
                    <div class="ui-block-c" style="width:10%;">

                    </div>
                    <div class="ui-block-d" style="width:35%;">
                        <input type="number" name="max_price" placeholder="最高">
                    </div>
                </div>



                <div class="ui-grid-solo">
                    <div class="ui-block-a">
                        <label class="form-label">详细描述</label>
                        <textarea name="content" placeholder="描述颜色、大小、形状、新旧等需求"></textarea>
                    </div>
                </div>

                <div>
                    <input type="hidden" name="latitude" id="latitude"></input>
                    <input type="hidden" name="longitude" id="longitude"></input>
                </div>

                <div class="ui-grid-a">
                    <div class="ui-block-a" style="width:20%;">
                        <label id="prefer-contact" class="form-label">联系方式</label>
                    </div>
                    <div class="ui-block-b" style="width:80%;">
                        <div data-role="fieldcontain">
                            <fieldset data-role="controlgroup" data-type="horizontal">
                                <input type="checkbox" name="phone-checked" id="phone-checked" onchange="phoneContactChange()" />
                                <label for="phone-checked">
                                    <img src="/static/images/general/mobile.png" style="width: 30px; height: 30px" />
                                </label>
                                <input type="checkbox" name="email-checked" id="email-checked"/>
                                <label for="email-checked">
                                    <img src="/static/images/general/email.png" style="width: 30px; height: 30px"/>
                                </label>
                                <input type="checkbox" name="qq-checked" id="qq-checked" onchange="qqContactChange()" />
                                <label for="qq-checked">
                                    <img src="/static/images/general/weixin.jpg" style="width: 30px; height: 30px" />
                                </label>
                            </fieldset>
                        </div>
                        <div id="phone_number_div">
                            <input type="text" name="phone_number" placeholder="手机号码">
                            <p id="phone_required" style="color: red;"></p>
                        </div>
                        <div id="qq_number_div">
                            <input type="text" name="qq_number" placeholder="QQ号码">
                            <p id="qq_required" style="color: red;"></p>
                        </div>
                    </div>
                </div>
                <div>
                    <input type="image" value="Submit" id="submit_btn" src="https://s3-us-west-2.amazonaws.com/beike-s3/static/img/04/submit.png">
                </div>
            </form>
        </div>
        <div data-role="footer" data-position="fixed">
            <div style="background-color: rgb(35,192,148);">
                <div class="ui-grid-d">
                    <div class="ui-block-a">
                        <a href="/">
                            <img height="40" width="40" style = "padding:12px 5px 5px 12px;" src='/static/images/navigation/homepage_clicked.png' />
                        </a>
                    </div>
                    <div class="ui-block-b">
                        <a href="/sell/form">
                            <img height="50" width="40" style = "padding:5px;" src='/static/images/navigation/buy_form_clicked.png' />
                        </a>
                    </div>
                    <div class="ui-block-c">
                        <a href="/sell/form">
                            <img height="50" width="40" style = "padding:5px;" src='/static/images/navigation/sell_form_clicked.png' />
                        </a>
                    </div>
                    <div class="ui-block-d">
                        <a href="/sell/form">
                            <img height="50" width="50" style = "padding:5px;" src='/static/images/navigation/buy_posts_clicked.png' />
                        </a>
                    </div>
                    <div class="ui-block-e">
                        <a href="/sell/form">
                            <img height="50" width="50" style = "padding:5px;" src='/static/images/navigation/sell_posts_clicked.png' />
                        </a>
                    </div>
                </div>    
            </div>
        </div>
        <script type="text/javascript">
        function getLatitudeLongtitude(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            $("#latitude").val(latitude);
            $("#longitude").val(longitude);
            $.ajax({
                type: "get",
                url: "/me/get_info/get_zipcode_by_latlong",
                dataType: "json",
                data: {
                    latitude: latitude,
                    longitude: longitude
                }
            }).then(function(data) {
                console.log(data);
            });
        }

        $(document).ready(function() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(getLatitudeLongtitude);
            }
        });
        </script>
    </div>
</body>

</html>
